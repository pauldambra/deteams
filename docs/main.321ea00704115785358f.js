(()=>{"use strict";var e,t={1070:(e,t,n)=>{t.__esModule=!0,t.deteamsify=void 0;var a=n(3740);t.deteamsify=function(e){var t=function(e){return{hiddenURL:e.searchParams.get("objectUrl")}}(e),n=function(e){var t=e.hash;if(t.startsWith("#/xlsx/viewer/teams/"))return{downloadURL:t.replace(/^#\/xlsx\/viewer\/teams\//,"").replace(/~2F/g,"/")}}(e);return t.hiddenURL?(a.send(""),t):n?(a.send(""),n):void a.send("no hidden URL found in this teams URL, soz. 🤷‍♀️")}},2240:(e,t)=>{t.__esModule=!0,t.listItem=t.span=t.text=t.link=void 0,t.link=function(e){var t=document.createElement("a"),n=document.createTextNode(e);return t.appendChild(n),t.title=e,t.href=e,t.target="_blank",t},t.text=function(e){return document.createTextNode(e)},t.span=function(e){for(var t=document.createElement("span"),n=0,a=e;n<a.length;n++){var i=a[n];t.appendChild(i)}return t},t.listItem=function(e){var t=document.createElement("li");return t.appendChild(e),t}},3607:(e,t,n)=>{var a=n(9666),i=n(3232),r=n(2672),s=n(1070),o=n(2240),d=n(3740),l=function(e){document.getElementsByClassName("message")[0].innerHTML=e.message},u=function(e){if(e)if(e.hiddenURL){var t=document.getElementsByClassName("links")[0].children[0],n=o.listItem(o.link(e.hiddenURL));t.prepend(n)}else e.downloadURL&&(t=document.getElementsByClassName("links")[0].children[0],n=o.listItem(o.span([o.text("this is probably a download link for "),o.link(e.downloadURL)])),t.prepend(n))},c=function(e){return d.send(""),!!(e&&e.length>0)};document.addEventListener("DOMContentLoaded",(function(){a.fromEvent(document.getElementsByClassName("undeteamsified"),"input").pipe(i.debounceTime(200),i.map((function(e){return e.target.value})),i.filter(c),i.filter(r.isValidHttpUrl),i.map((function(e){return new URL(e)})),i.filter(r.isTeamsLink),i.filter(r.mightContainASecretHiddenLink),i.map(s.deteamsify)).subscribe(u,l)}))},3740:(e,t,n)=>{t.__esModule=!0,t.send=void 0;var a=new(n(9666).Subject);a.subscribe((function(e){"undefined"!=typeof document&&(document.getElementsByClassName("message")[0].textContent=e)})),t.send=function(e){return a.next(e)}},2672:(e,t,n)=>{t.__esModule=!0,t.mightContainASecretHiddenLink=t.isTeamsLink=t.isValidHttpUrl=void 0;var a=n(3740);t.isValidHttpUrl=function(e){var t;try{t=new URL(e)}catch(e){return a.send("That's not an HTTP URL"),!1}return"http:"===t.protocol||"https:"===t.protocol||(a.send("That's not an HTTP URL"),!1)},t.isTeamsLink=function(e){return"teams.microsoft.com"===e.host||(a.send("That's not a teams URL"),!1)},t.mightContainASecretHiddenLink=function(e){var t;return!!((t=e)&&t.search&&t.search.includes("https%3A%2F%2F")||function(e){return e&&e.hash&&e.hash.includes("https:~2F~2F")}(e))||(e.pathname.includes("channel")||e.pathname.includes("thread.skype")?(a.send("That teams link does not contain a hidden link. It looks like a link to a teams team team channel, you might have to use teams 🤬"),!1):(a.send("That teams link does not contain a hidden link. to deteamsify - just stop using teams"),!1))}}},n={};function a(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,n,i,r)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){for(var[n,i,r]=e[l],o=!0,d=0;d<n.length;d++)(!1&r||s>=r)&&Object.keys(a.O).every((e=>a.O[e](n[d])))?n.splice(d--,1):(o=!1,r<s&&(s=r));o&&(e.splice(l--,1),t=i())}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[n,i,r]},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[s,o,d]=n,l=0;for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(d)var u=d(a);for(t&&t(n);l<s.length;l++)r=s[l],a.o(e,r)&&e[r]&&e[r][0](),e[s[l]]=0;return a.O(u)},n=self.webpackChunkdeteams=self.webpackChunkdeteams||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=a.O(void 0,[216],(()=>a(3607)));i=a.O(i)})();