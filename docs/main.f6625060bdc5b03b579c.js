(()=>{"use strict";var e,t={664:(e,t,n)=>{var a=n(478),s=n(833),o=n(127),r=n(975);const d=new(n(716).x);d.subscribe((e=>{"undefined"!=typeof document&&(document.getElementsByClassName("message")[0].textContent=e)}));const i=e=>d.next(e),l=e=>{let t;try{t=new URL(e)}catch(e){return i("That's not an HTTP URL"),!1}return"http:"===t.protocol||"https:"===t.protocol||(i("That's not an HTTP URL"),!1)},c=e=>"teams.microsoft.com"===e.host||(i("That's not a teams URL"),!1),h=e=>!(!(e=>e&&e.search&&e.search.includes("https%3A%2F%2F"))(e)&&!(e=>e&&e.hash&&e.hash.includes("https:~2F~2F"))(e)&&(e.pathname.includes("channel")||e.pathname.includes("thread.skype")?(i("That teams link does not contain a hidden link. It looks like a link to a teams team team channel, you might have to use teams 🤬"),1):(i("That teams link does not contain a hidden link. to deteamsify - just stop using teams"),1))),m=e=>{const t=(e=>({hiddenURL:e.searchParams.get("objectUrl")}))(e),n=function(e){const t=e.hash;if(t.startsWith("#/xlsx/viewer/teams/"))return{downloadURL:t.replace(/^#\/xlsx\/viewer\/teams\//,"").replace(/\~2F/g,"/")}}(e);return t.hiddenURL?(i(""),t):n?(i(""),n):void i("no hidden URL found in this teams URL, soz. 🤷‍♀️")},u=e=>{const t=document.createElement("a"),n=document.createTextNode(e);return t.appendChild(n),t.title=e,t.href=e,t.target="_blank",t},p=(e,t="500px")=>{const n=document.createElement("li");return n.width=t,n.appendChild(e),n},f=e=>{document.getElementsByClassName("message")[0].innerHTML=e.message},g=e=>{if(e.hiddenURL){const t=document.getElementsByClassName("output")[0],n=document.getElementsByClassName("links")[0].children[0],a=p(u(e.hiddenURL),t.width);n.prepend(a)}else if(e.downloadURL){const t=document.getElementsByClassName("output")[0],n=document.getElementsByClassName("links")[0].children[0],a=p((e=>{const t=document.createElement("span");for(const n of e)t.appendChild(n);return t})([("this is probably a download link for ",document.createTextNode("this is probably a download link for ")),u(e.downloadURL,t.width)]));n.prepend(a)}},v=e=>(i(""),!!(e&&e.length>0));document.addEventListener("DOMContentLoaded",(()=>{(0,a.R)(document.getElementsByClassName("undeteamsified"),"input").pipe((0,s.b)(200),(0,o.U)((e=>e.target.value)),(0,r.h)(v),(0,r.h)(l),(0,o.U)((e=>new URL(e))),(0,r.h)(c),(0,r.h)(h),(0,o.U)(m)).subscribe(g,f)}))}},n={};function a(e){var s=n[e];if(void 0!==s)return s.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.m=t,e=[],a.O=(t,n,s,o)=>{if(!n){var r=1/0;for(l=0;l<e.length;l++){for(var[n,s,o]=e[l],d=!0,i=0;i<n.length;i++)(!1&o||r>=o)&&Object.keys(a.O).every((e=>a.O[e](n[i])))?n.splice(i--,1):(d=!1,o<r&&(r=o));d&&(e.splice(l--,1),t=s())}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,s,o]},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var s,o,[r,d,i]=n,l=0;for(s in d)a.o(d,s)&&(a.m[s]=d[s]);if(i)var c=i(a);for(t&&t(n);l<r.length;l++)o=r[l],a.o(e,o)&&e[o]&&e[o][0](),e[r[l]]=0;return a.O(c)},n=self.webpackChunkdeteams=self.webpackChunkdeteams||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=a.O(void 0,[216],(()=>a(664)));s=a.O(s)})();