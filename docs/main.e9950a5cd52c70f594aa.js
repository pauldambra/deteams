(()=>{"use strict";var e,t={5125:(e,t)=>{t.__esModule=!0,t.createChain=t.ReadViewerURLFromHash=t.ReadTeamsLinkFromSearchParams=t.TypeOfTeamsURL=t.IsTeamsURL=t.IsHTTPURL=t.HasContent=void 0;var n=function(){function e(e){this.nextLink=e}return e.prototype.handle=function(e){return e&&e.length>0?this.nextLink.handle(e):{error:"there must be content in the string"}},e}();t.HasContent=n;var r=function(){function e(e){this.nextLink=e}return e.prototype.handle=function(e){var t;try{t=new URL(e)}catch(e){return{error:"you must provide a web URL"}}return"http:"===t.protocol||"https:"===t.protocol?this.nextLink.handle(t):{error:"you must provide a web URL"}},e}();t.IsHTTPURL=r;var a=function(){function e(e){this.nextLink=e}return e.prototype.handle=function(e){return"teams.microsoft.com"===e.host?this.nextLink.handle(e):{error:"that's not a Teams link"}},e}();t.IsTeamsURL=a;var i=function(){function e(e,t){this.linkInSearchParamNext=e,this.viewerURLINHashNext=t}return e.prototype.handle=function(e){var t;return(t=e)&&t.search&&t.search.includes("https%3A%2F%2F")?this.linkInSearchParamNext.handle(e):function(e){return e&&e.hash&&e.hash.includes("https:~2F~2F")}(e)?this.viewerURLINHashNext.handle(e):e.pathname.includes("channel")||e.pathname.includes("thread.skype")?{error:"That teams link does not contain a hidden link. It looks like a link to a teams team team channel, you might have to use teams 🤬"}:{error:"That teams link does not contain a hidden link. to deteamsify - just stop using teams"}},e}();t.TypeOfTeamsURL=i;var o=function(){function e(){}return e.prototype.handle=function(e){var t=e.searchParams.get("objectUrl");return t?{hiddenURL:t}:{error:"unexpected error, maybe refresh and try again"}},e}();t.ReadTeamsLinkFromSearchParams=o;var s=function(){function e(){}return e.prototype.handle=function(e){var t=e.hash;return t.startsWith("#/xlsx/viewer/teams/")?{downloadURL:t.replace(/^#\/xlsx\/viewer\/teams\//,"").replace(/~2F/g,"/")}:{error:"this viewer URL can't be processed, please report a bug"}},e}();t.ReadViewerURLFromHash=s,t.createChain=function(){return new n(new r(new a(new i(new o,new s))))}},1070:(e,t,n)=>{t.__esModule=!0,t.deteamsify=void 0;var r=n(3740);t.deteamsify=function(e){var t=function(e){return{hiddenURL:e.searchParams.get("objectUrl")}}(e),n=function(e){var t=e.hash;if(t.startsWith("#/xlsx/viewer/teams/"))return{downloadURL:t.replace(/^#\/xlsx\/viewer\/teams\//,"").replace(/~2F/g,"/")}}(e);return t.hiddenURL?(r.send(""),t):n?(r.send(""),n):void r.send("no hidden URL found in this teams URL, soz. 🤷‍♀️")}},2240:(e,t)=>{t.__esModule=!0,t.listItem=t.span=t.text=t.link=void 0,t.link=function(e){var t=document.createElement("a"),n=document.createTextNode(e);return t.appendChild(n),t.title=e,t.href=e,t.target="_blank",t},t.text=function(e){return document.createTextNode(e)},t.span=function(e){for(var t=document.createElement("span"),n=0,r=e;n<r.length;n++){var a=r[n];t.appendChild(a)}return t},t.listItem=function(e){var t=document.createElement("li");return t.appendChild(e),t}},3607:(e,t,n)=>{var r=n(9666),a=n(3232),i=n(2672),o=n(1070),s=n(2240),d=n(3740),u=n(5125),l=function(e){document.getElementsByClassName("message")[0].innerHTML=e.message},c=function(e){if(e)if(e.hiddenURL){var t=document.getElementsByClassName("links")[0].children[0],n=s.listItem(s.link(e.hiddenURL));t.prepend(n)}else e.downloadURL&&(t=document.getElementsByClassName("links")[0].children[0],n=s.listItem(s.span([s.text("this is probably a download link for "),s.link(e.downloadURL)])),t.prepend(n))},h=function(e){return d.send(""),!!(e&&e.length>0)},m=u.createChain();document.addEventListener("DOMContentLoaded",(function(){r.fromEvent(document.getElementsByClassName("undeteamsified"),"input").pipe(a.debounceTime(200),a.map((function(e){return e.target.value})),a.filter(h),a.filter(i.isValidHttpUrl),a.map((function(e){return new URL(e)})),a.filter(i.isTeamsLink),a.filter(i.mightContainASecretHiddenLink),a.map(o.deteamsify)).subscribe(console.log,console.log),r.fromEvent(document.getElementsByClassName("undeteamsified"),"input").pipe(a.debounceTime(200),a.map((function(e){return e.target.value})),a.map((function(e){return m.handle(e)}))).subscribe(c,l)}))},3740:(e,t,n)=>{t.__esModule=!0,t.send=void 0;var r=new(n(9666).Subject);r.subscribe((function(e){"undefined"!=typeof document&&document.getElementsByClassName("message")[0]&&(document.getElementsByClassName("message")[0].textContent=e)})),t.send=function(e){return r.next(e)}},2672:(e,t,n)=>{t.__esModule=!0,t.mightContainASecretHiddenLink=t.isTeamsLink=t.isValidHttpUrl=void 0;var r=n(3740);t.isValidHttpUrl=function(e){var t;try{t=new URL(e)}catch(e){return r.send("That's not an HTTP URL"),!1}return"http:"===t.protocol||"https:"===t.protocol||(r.send("That's not an HTTP URL"),!1)},t.isTeamsLink=function(e){return"teams.microsoft.com"===e.host||(r.send("That's not a teams URL"),!1)},t.mightContainASecretHiddenLink=function(e){var t;return!!((t=e)&&t.search&&t.search.includes("https%3A%2F%2F")||function(e){return e&&e.hash&&e.hash.includes("https:~2F~2F")}(e))||(e.pathname.includes("channel")||e.pathname.includes("thread.skype")?(r.send("That teams link does not contain a hidden link. It looks like a link to a teams team team channel, you might have to use teams 🤬"),!1):(r.send("That teams link does not contain a hidden link. to deteamsify - just stop using teams"),!1))}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,a,i)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,a,i]=e[u],s=!0,d=0;d<n.length;d++)(!1&i||o>=i)&&Object.keys(r.O).every((e=>r.O[e](n[d])))?n.splice(d--,1):(s=!1,i<o&&(o=i));s&&(e.splice(u--,1),t=a())}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,a,i]},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[o,s,d]=n,u=0;for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(d)var l=d(r);for(t&&t(n);u<o.length;u++)i=o[u],r.o(e,i)&&e[i]&&e[i][0](),e[o[u]]=0;return r.O(l)},n=self.webpackChunkdeteams=self.webpackChunkdeteams||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[216],(()=>r(3607)));a=r.O(a)})();