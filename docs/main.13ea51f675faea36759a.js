(()=>{"use strict";var e,n={5125:(e,n)=>{n.__esModule=!0,n.createChain=n.ReadViewerURLFromHash=n.ReadTeamsLinkFromSearchParams=n.TypeOfTeamsURL=n.IsTeamsURL=n.IsHTTPURL=n.HasContent=void 0;var t=function(){function e(e){this.nextLink=e}return e.prototype.handle=function(e){return e&&e.length>0?this.nextLink.handle(e):{error:"there must be content in the string"}},e}();n.HasContent=t;var r=function(){function e(e){this.nextLink=e}return e.prototype.handle=function(e){var n;try{n=new URL(e)}catch(e){return{error:"you must provide a web URL"}}return"http:"===n.protocol||"https:"===n.protocol?this.nextLink.handle(n):{error:"you must provide a web URL"}},e}();n.IsHTTPURL=r;var a=function(){function e(e){this.nextLink=e}return e.prototype.handle=function(e){return"teams.microsoft.com"===e.host?this.nextLink.handle(e):{error:"that's not a Teams link"}},e}();n.IsTeamsURL=a;var o=function(){function e(e,n){this.linkInSearchParamNext=e,this.viewerURLINHashNext=n}return e.prototype.handle=function(e){var n;return(n=e)&&n.search&&n.search.includes("https%3A%2F%2F")?this.linkInSearchParamNext.handle(e):function(e){return e&&e.hash&&e.hash.includes("https:~2F~2F")}(e)?this.viewerURLINHashNext.handle(e):e.pathname.includes("channel")||e.pathname.includes("thread.skype")?{error:"That teams link does not contain a hidden link. It looks like a link to a teams team team channel, you might have to use teams ðŸ¤¬"}:{error:"That teams link does not contain a hidden link. to deteamsify - just stop using teams"}},e}();n.TypeOfTeamsURL=o;var s=function(){function e(){}return e.prototype.handle=function(e){var n=e.searchParams.get("objectUrl");return n?{hiddenURL:n}:{error:"unexpected error, maybe refresh and try again"}},e}();n.ReadTeamsLinkFromSearchParams=s;var i=function(){function e(){}return e.prototype.handle=function(e){var n=e.hash;return n.startsWith("#/xlsx/viewer/teams/")?{downloadURL:n.replace(/^#\/xlsx\/viewer\/teams\//,"").replace(/~2F/g,"/")}:{error:"this viewer URL can't be processed, please report a bug"}},e}();n.ReadViewerURLFromHash=i,n.createChain=function(){return new t(new r(new a(new o(new s,new i))))}},2240:(e,n)=>{n.__esModule=!0,n.listItem=n.span=n.text=n.link=void 0,n.link=function(e){var n=document.createElement("a"),t=document.createTextNode(e);return n.appendChild(t),n.title=e,n.href=e,n.target="_blank",n},n.text=function(e){return document.createTextNode(e)},n.span=function(e){for(var n=document.createElement("span"),t=0,r=e;t<r.length;t++){var a=r[t];n.appendChild(a)}return n},n.listItem=function(e){var n=document.createElement("li");return n.appendChild(e),n}},3607:(e,n,t)=>{var r=t(9666),a=t(3232),o=t(2240),s=t(3740),i=t(5125),u=function(e){document.getElementsByClassName("message")[0].innerHTML=e.message},d=function(e){if(e.hiddenURL){var n=document.getElementsByClassName("links")[0].children[0],t=o.listItem(o.link(e.hiddenURL));n.prepend(t)}else e.downloadURL?(n=document.getElementsByClassName("links")[0].children[0],t=o.listItem(o.span([o.text("this is probably a download link for "),o.link(e.downloadURL)])),n.prepend(t)):e.error?s.send(e.error):s.send("unexpected error, please log a bug")},l=i.createChain();document.addEventListener("DOMContentLoaded",(function(){r.fromEvent(document.getElementsByClassName("undeteamsified"),"input").pipe(a.debounceTime(200),a.map((function(e){return e.target.value})),a.map((function(e){return l.handle(e)}))).subscribe(d,u)}))},3740:(e,n,t)=>{n.__esModule=!0,n.send=void 0;var r=new(t(9666).Subject);r.subscribe((function(e){"undefined"!=typeof document&&document.getElementsByClassName("message")[0]&&(document.getElementsByClassName("message")[0].textContent=e)})),n.send=function(e){return r.next(e)}}},t={};function r(e){var a=t[e];if(void 0!==a)return a.exports;var o=t[e]={exports:{}};return n[e](o,o.exports,r),o.exports}r.m=n,e=[],r.O=(n,t,a,o)=>{if(!t){var s=1/0;for(d=0;d<e.length;d++){for(var[t,a,o]=e[d],i=!0,u=0;u<t.length;u++)(!1&o||s>=o)&&Object.keys(r.O).every((e=>r.O[e](t[u])))?t.splice(u--,1):(i=!1,o<s&&(s=o));i&&(e.splice(d--,1),n=a())}return n}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[t,a,o]},r.d=(e,n)=>{for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};r.O.j=n=>0===e[n];var n=(n,t)=>{var a,o,[s,i,u]=t,d=0;for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(u)var l=u(r);for(n&&n(t);d<s.length;d++)o=s[d],r.o(e,o)&&e[o]&&e[o][0](),e[s[d]]=0;return r.O(l)},t=self.webpackChunkdeteams=self.webpackChunkdeteams||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var a=r.O(void 0,[216],(()=>r(3607)));a=r.O(a)})();